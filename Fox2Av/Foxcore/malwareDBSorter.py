# -*- coding: utf-8 -*-
# Author : github.com/miho030

#-----------------------------------------------------------------------------------------------------
# DB를 정리하여 루틴에 적용하는 모듈
#-----------------------------------------------------------------------------------------------------
import os

# global variable
DB_PATH = os.path.abspath("../Foxdb/main.hdb") # maleware DB
memory = 1024 * 100 # 102400
File_Hash_List, File_Size_List, File_Name_List = [], [],  []

def DB_Pattern():
    with open(DB_PATH, "rb") as fdb:
        for hdb in fdb.readlines(memory):  # 지정된 메모리 안에서 DB를 불러옴. >>
            hdb = hdb.split(str('\n'))[0]
            File_Hash_List.append(str(hdb.split(str(':'))[0]))  # DB에서 맨 앞부분(파일용량)부분만 잘라서 FSL(FileSizeList)에 추가
            File_Size_List.append(int(hdb.split(str(':'))[1]))  # DB에서 두번째 부분(파일md5해시)부분만 잘라서 FHL(FileHashList)
            File_Name_List.append(str(hdb.split(str(':'))[2]))  # DB에서 세번째 부분(파일 이름)부분 잘라서 FNL(FileNAmeList)

    return File_Hash_List, File_Size_List, File_Name_List
